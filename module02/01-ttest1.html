<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ttest1 – ENVX1002 Handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dece3bd051e391dd7205a6b15f93dc59.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-ed04999718f06b735b1f8009dce43b94.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dfc32c3a0e9c8e7b4b1acc226d859f42.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-2bdf95e56c83e920f8611d77e967c40c.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ENVX1002 Handbook</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="../#" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../module02/01-ttest1.html"><strong>📗 Module 2</strong></a></li><li class="breadcrumb-item"><a href="../module02/01-ttest1.html">One-sample <span class="math inline">\(t\)</span>-test</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../001-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to statistics</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>📕 Module 1</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../module01/01-intro_statistical_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Statistical Programming</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>📗 Module 2</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../module02/01-ttest1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">One-sample <span class="math inline">\(t\)</span>-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../module02/02-ttest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two-sample <span class="math inline">\(t\)</span>-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../module02/03-nonparametric1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chi-squared tests</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>📘 Module 3</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../module03/040-describing_relationships.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Describing relationships</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../module03/041-linear_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Why do we create models?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../module03/042-linear_functions_multi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../module03/043-nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Non-linear regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>🖥️ Computer labs</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab01.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 01 – Getting started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab02.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 02 – Statistical programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab03.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 03 – Probability distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab04.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 04 – Sampling distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab05.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 05 – Hypothesis Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab06.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 06 – Two-sample <em>t</em>-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab07.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 07 – Chi-squared test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab08.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 08 – 🚫 No exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab09.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 9 - Describing relationships</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab10.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 10 - Linear Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab11.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 11 - Multiple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab12.html" class="sidebar-item-text sidebar-link" target="_blank">
 <span class="menu-text">Lab 12 - Non-linear models</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#one-sample-t-test" id="toc-one-sample-t-test" class="nav-link active" data-scroll-target="#one-sample-t-test">One-sample <span class="math inline">\(t\)</span>-test</a>
  <ul class="collapse">
  <li><a href="#confidence-intervals-for-mu" id="toc-confidence-intervals-for-mu" class="nav-link" data-scroll-target="#confidence-intervals-for-mu">Confidence intervals for <span class="math inline">\(\mu\)</span></a></li>
  <li><a href="#confidence-interval-for-mu-when-sigma-is-known-and-data-is-normally-distributed" id="toc-confidence-interval-for-mu-when-sigma-is-known-and-data-is-normally-distributed" class="nav-link" data-scroll-target="#confidence-interval-for-mu-when-sigma-is-known-and-data-is-normally-distributed">Confidence interval for <span class="math inline">\(\mu\)</span> (when <span class="math inline">\(\sigma\)</span> is known and data is normally distributed)</a></li>
  <li><a href="#confidence-interval-for-mu-when-sigma-is-not-known-and-data-is-normally-distributed" id="toc-confidence-interval-for-mu-when-sigma-is-not-known-and-data-is-normally-distributed" class="nav-link" data-scroll-target="#confidence-interval-for-mu-when-sigma-is-not-known-and-data-is-normally-distributed">Confidence interval for <span class="math inline">\(\mu\)</span> (when <span class="math inline">\(\sigma\)</span> is <strong>NOT</strong> known and data is normally distributed)</a>
  <ul class="collapse">
  <li><a href="#students-t-distribution" id="toc-students-t-distribution" class="nav-link" data-scroll-target="#students-t-distribution">Student’s T Distribution</a></li>
  <li><a href="#t-based-confidence-interval" id="toc-t-based-confidence-interval" class="nav-link" data-scroll-target="#t-based-confidence-interval">T-Based Confidence Interval</a></li>
  </ul></li>
  <li><a href="#what-is-meant-by-confidence-interval" id="toc-what-is-meant-by-confidence-interval" class="nav-link" data-scroll-target="#what-is-meant-by-confidence-interval">What is meant by confidence interval?</a></li>
  <li><a href="#data-transformation-and-the-lognormal-distribution" id="toc-data-transformation-and-the-lognormal-distribution" class="nav-link" data-scroll-target="#data-transformation-and-the-lognormal-distribution">Data Transformation and the Lognormal Distribution</a>
  <ul class="collapse">
  <li><a href="#the-natural-log-log_e-transformation" id="toc-the-natural-log-log_e-transformation" class="nav-link" data-scroll-target="#the-natural-log-log_e-transformation">The Natural Log (<span class="math inline">\(\log_e\)</span>) Transformation</a></li>
  </ul></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis testing</a>
  <ul class="collapse">
  <li><a href="#steps-in-hypothesis-testing-via-a-test-statistic" id="toc-steps-in-hypothesis-testing-via-a-test-statistic" class="nav-link" data-scroll-target="#steps-in-hypothesis-testing-via-a-test-statistic">Steps in Hypothesis Testing (via a Test Statistic)</a></li>
  <li><a href="#one-tailed-and-two-tailed-tests" id="toc-one-tailed-and-two-tailed-tests" class="nav-link" data-scroll-target="#one-tailed-and-two-tailed-tests">One-Tailed and Two-Tailed Tests</a></li>
  <li><a href="#type-i-and-type-ii-errors" id="toc-type-i-and-type-ii-errors" class="nav-link" data-scroll-target="#type-i-and-type-ii-errors">Type I and Type II Errors</a></li>
  <li><a href="#power-of-the-test" id="toc-power-of-the-test" class="nav-link" data-scroll-target="#power-of-the-test">Power of the Test</a></li>
  </ul></li>
  <li><a href="#one-sample-z-tests" id="toc-one-sample-z-tests" class="nav-link" data-scroll-target="#one-sample-z-tests">One-Sample z-Tests</a>
  <ul class="collapse">
  <li><a href="#introductory-example" id="toc-introductory-example" class="nav-link" data-scroll-target="#introductory-example">Introductory Example</a></li>
  </ul></li>
  <li><a href="#general-notes-on-hypothesis-testing" id="toc-general-notes-on-hypothesis-testing" class="nav-link" data-scroll-target="#general-notes-on-hypothesis-testing">General Notes on Hypothesis Testing</a></li>
  <li><a href="#one-sample-t-tests" id="toc-one-sample-t-tests" class="nav-link" data-scroll-target="#one-sample-t-tests">One-Sample t-Tests</a>
  <ul class="collapse">
  <li><a href="#introductory-example-1" id="toc-introductory-example-1" class="nav-link" data-scroll-target="#introductory-example-1">Introductory Example</a></li>
  <li><a href="#general-notes-on-the-t-distribution" id="toc-general-notes-on-the-t-distribution" class="nav-link" data-scroll-target="#general-notes-on-the-t-distribution">General Notes on the T Distribution</a></li>
  </ul></li>
  <li><a href="#steps-in-hypothesis-testing-via-a-confidence-interval" id="toc-steps-in-hypothesis-testing-via-a-confidence-interval" class="nav-link" data-scroll-target="#steps-in-hypothesis-testing-via-a-confidence-interval">Steps in Hypothesis Testing (via a Confidence Interval)</a></li>
  <li><a href="#one-sample-t-test-with-data-transformation" id="toc-one-sample-t-test-with-data-transformation" class="nav-link" data-scroll-target="#one-sample-t-test-with-data-transformation">One-Sample t-Test with Data Transformation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../module02/01-ttest1.html"><strong>📗 Module 2</strong></a></li><li class="breadcrumb-item"><a href="../module02/01-ttest1.html">One-sample <span class="math inline">\(t\)</span>-test</a></li></ol></nav></header>




<section id="one-sample-t-test" class="level1">
<h1>One-sample <span class="math inline">\(t\)</span>-test</h1>
<section id="confidence-intervals-for-mu" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals-for-mu">Confidence intervals for <span class="math inline">\(\mu\)</span></h2>
<p>Confidence intervals (CI) are also known as “confidence limits”. Most commonly we generate a confidence interval (CI) for <span class="math inline">\(\mu\)</span> (the population mean) but you may also see CI’s for the population variance <span class="math inline">\(\sigma\)</span>, or for the population probability <span class="math inline">\(p\)</span> in literature.</p>
<p>A confidence interval consists of two values (an upper and a lower limit). It is generally written as the two values separated by a comma within brackets e.g.&nbsp;(3.3, 4.1), with the lower value on the left, and the upper value on the right. We must specify a degree of likelihood or confidence that the population mean <span class="math inline">\(\mu\)</span> is located in this interval. To be more confident that the interval includes <span class="math inline">\(\mu\)</span>, the width of the interval must be increased e.g.&nbsp;99% CI. The most commonly chosen level or confidence is 95%, but you will also see 90% and 99% CI’s in literature.</p>
</section>
<section id="confidence-interval-for-mu-when-sigma-is-known-and-data-is-normally-distributed" class="level2">
<h2 class="anchored" data-anchor-id="confidence-interval-for-mu-when-sigma-is-known-and-data-is-normally-distributed">Confidence interval for <span class="math inline">\(\mu\)</span> (when <span class="math inline">\(\sigma\)</span> is known and data is normally distributed)</h2>
<p>(From Glover &amp; Mitchell, 2002.) The sample mean <span class="math inline">\(\bar y\)</span> is an unbiased estimator of the population mean <span class="math inline">\(\mu\)</span>. <span class="math inline">\(\bar y\)</span>’s are not all the same due to sampling variability. Their scatter depends on both the variability of the y’s, measured by <span class="math inline">\(\sigma\)</span>, and the sample size <span class="math inline">\(n\)</span>. Recall that the standard error of the mean is <span class="math inline">\(\sqrt{\frac{\sigma^2}{n}}\)</span> and we also know that the random variable <span class="math inline">\(\frac{\bar y -\mu}{\sqrt{\frac{\sigma^2}{n}}}\)</span> is distributed as the standard normal or the Z distribution.</p>
<p><strong>EXAMPLE</strong></p>
<p>For the sampling distribution of this Z variable, consider what two values of capture the middle 95% of the distribution? That is, for <span class="math inline">\(P(a \le Z \le b) = 0.95\)</span>, what are a and b?</p>
<ul>
<li>If <span class="math inline">\(P(Z \le a) = 0.025\)</span>, then looking up 0.025 in R or the body of the standard normal table we find <span class="math inline">\(a \approx -1.960\)</span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.025</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>If <span class="math inline">\(P(Z \le b) = 0.975\)</span> then looking up 0.975 in R or the body of the standard normal table we find <span class="math inline">\(b \approx 1.960\)</span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.725</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So <span class="math inline">\(P(-1.960 \le Z \le 1.960) = 0.95\)</span>, or the values ± 1.960 capture the middle 95% of the Z distribution.</p>
<p>Therefore we capture the middle 95% of the <span class="math inline">\(\bar y\)</span>’s if</p>
<p><span class="math inline">\(P\left(-1.960 \leq \frac{\bar{X} - \mu}{\frac{\sigma}{\sqrt{n}}} \leq 1.960\right) = 0.95\)</span></p>
<p><span class="math inline">\(\leftrightarrow P\left(-1.960 \frac{\sigma}{\sqrt{n}} \leq \bar{X} - \mu \leq 1.960 \frac{\sigma}{\sqrt{n}}\right) = 0.95\)</span></p>
<p><span class="math inline">\(\leftrightarrow P\left(\bar{X} -1.960 \frac{\sigma}{\sqrt{n}} \leq \mu \leq \bar{X} +1.960 \frac{\sigma}{\sqrt{n}}\right) = 0.95\)</span></p>
<p><span class="math inline">\(\leftrightarrow P\left(\bar{X} -1.960 \frac{\sigma}{\sqrt{n}} \leq \mu \leq \bar{X} +1.960 \frac{\sigma}{\sqrt{n}}\right) = 0.95\)</span></p>
<p>From the final equation above, we can say that the probability that the sample mean will differ by no more than 1.960 standard errors <span class="math inline">\(\sqrt{\frac{\sigma^2}{n}}\)</span> from the population mean <span class="math inline">\(\mu\)</span> is 0.95.</p>
<p>More commonly the equation for a CI is given as</p>
<p><span class="math inline">\(\text{95 % CI} = \bar{y} \pm z_{0.025} \times s.e.\)</span></p>
<p>where <span class="math inline">\(z^{0.025}\)</span> is a critical value from the standard normal distribution (also known as the z distribution). 2.5% of data lies to the right of <span class="math inline">\(z^{0.025}\)</span>. Equivalently, 97.5% of data lies to the left of <span class="math inline">\(z^{0.025}\)</span>. To find this value, you would look up a cumulative probability of 0.975 in the standard normal table or use the formula =NORMINV(0.975,0,1) to find it in Excel. As we have seen above in R we can use the function qnorm(0.975)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For 90% or 99% confidence intervals, the only element of the CI formula that changes is the z critical value that is being used. So a <span class="math inline">\(\text{95 % CI} = \bar{y} \pm z_{0.05} \times s.e.\)</span> and a <span class="math inline">\(\text{99 % CI} = \bar{y} \pm z_{0.01} \times s.e.\)</span><br>
### Interpreting the Confidence Interval for <span class="math inline">\(\mu\)</span></p>
<p><span class="math inline">\(\bar y\)</span> is a random variable with a sampling distribution. Because there is an infinite number of values of <span class="math inline">\(\bar{y}\)</span>, there is an infinite number of intervals of the form <span class="math inline">\(\bar{y} \pm 1.96\frac{\sigma}{\sqrt{n}}\)</span>. The probability statement says that 95% of these intervals will actually include <span class="math inline">\(\mu\)</span> between the limits. For any one interval, <span class="math inline">\(\bar{y} \pm 1.96\frac{\sigma}{\sqrt{n}}\)</span>, we say that we are 95% confident that <span class="math inline">\(\mu\)</span> lies between these limits.</p>
<p><strong>EXAMPLE</strong></p>
<p>The following data shows the concentration of a toxic substance was measured in six ‘samples’ of effluent output. The readings were:</p>
<p>0.48 0.25 0.29 0.51 0.49 0.40</p>
<p>The mean for these six values is <span class="math inline">\(\bar y=0.403\)</span> <span class="math inline">\(\mu g/L\)</span>. Let’s assume that the concentration of this toxic substance follows a normal distribution and that <span class="math inline">\(\sigma = 0.1\)</span> <span class="math inline">\(\mu g/L\)</span>. These assumptions allow us to calculate a 95% z-based confidence interval:</p>
<p><span class="math inline">\(\bar{y} \pm z^{0.025}\frac{\sigma}{\sqrt{n}}\)</span></p>
<p>where <span class="math inline">\(z^{0.025} = 1.96\)</span> is the upper 2.5% point of the standard normal distribution.</p>
<p>So the 95% CI for the current example is</p>
<p><span class="math inline">\(0.403 \pm 1.96 \times \sqrt{\frac{0.1}{6}} = 0.403 \pm 0.080 = (0.323, 0.483)\)</span></p>
<p>We can say that we are 95% confident that the (population) mean concentration is somewhere in the range 0.323 to 0.483 <span class="math inline">\(\mu g/L\)</span>, although the best single estimate is 0.403 <span class="math inline">\(\mu g/L\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.48</span>, <span class="fl">0.25</span>, <span class="fl">0.29</span>, <span class="fl">0.51</span>, <span class="fl">0.49</span>, <span class="fl">0.40</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> mu <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span>z<span class="sc">*</span>se</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>ci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="confidence-interval-for-mu-when-sigma-is-not-known-and-data-is-normally-distributed" class="level2">
<h2 class="anchored" data-anchor-id="confidence-interval-for-mu-when-sigma-is-not-known-and-data-is-normally-distributed">Confidence interval for <span class="math inline">\(\mu\)</span> (when <span class="math inline">\(\sigma\)</span> is <strong>NOT</strong> known and data is normally distributed)</h2>
<p>There are very few times in a real world situation when you would know <span class="math inline">\(\sigma\)</span> and not know <span class="math inline">\(\mu\)</span>, so a z-based CI is very rarely used in practice. The more likely real-world situation would be that we take a sample from a population with unknown shape, mean, and standard deviation. From this sample we calculate <span class="math inline">\(\bar y\)</span> and <span class="math inline">\(s\)</span>. By the Central Limit Theorem, we assume <span class="math inline">\(\bar y\)</span>’s sampling distribution is approximately normal. We can now use <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span>, the <strong>sample standard error</strong>, as our estimate of <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span>, the <strong>population standard error</strong>. When <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span> replaces <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span> in the formula <span class="math inline">\(\frac{\bar y - \mu }{\frac{\sigma}{\sqrt{n}}}\)</span>, we have <span class="math inline">\(\frac{\bar y - \mu }{\frac{s}{\sqrt{n}}}\)</span>.</p>
<p>While the distribution of <span class="math inline">\(\frac{\bar y - \mu }{\frac{\sigma}{\sqrt{n}}}\)</span> is known to be the standard normal distribution or Z distribution, replacing <span class="math inline">\(\sigma\)</span> with <span class="math inline">\(s\)</span> will generate a different sampling distribution. This distribution is called the T distribution. (It is sometimes called the Student’s T distribution). A man named W.S. Gosset first published this sampling distribution in 1908.</p>
<section id="students-t-distribution" class="level3">
<h3 class="anchored" data-anchor-id="students-t-distribution">Student’s T Distribution</h3>
<p>The T-distribution has the following properties:</p>
<ul>
<li>It is bell-shaped, symmetrical about the mean, median and mode, which are all of equal value. [It is a little flatter than the normal distribution.]</li>
<li>The area under the curve = 1, as is the case for all continuous probability distributions.</li>
<li>The probability density function is defined by three parameters, the mean <span class="math inline">\(\mu\)</span>, the standard deviation <span class="math inline">\(\sigma\)</span> and the sample size <span class="math inline">\(n\)</span>. Note that the shape of the t distribution depends on the sample size, unlike that of the normal distribution (which only depends on <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>).</li>
<li>The exact shape of the t distribution depends on the quantity called degrees of freedom, <span class="math inline">\(df\)</span>. The <span class="math inline">\(df = n – 1\)</span> for any t distribution.</li>
<li>It approximates normality as <span class="math inline">\(n \rightarrow \infty\)</span>. The approximation is reasonably good for <span class="math inline">\(n &gt; 30\)</span> and can be regarded as exact for <span class="math inline">\(n &gt; 120\)</span>. You can see in Figure 5.1 (below) that for low sample sizes (and therefore small df) the T distribution is more spread out and flatter than the normal distribution. However, as the sample size (and df) increases the T curve becomes virtually indistinguishable from the Z e.g.&nbsp;T49 curve in Figure 8.1 where the degrees of freedom is 49.</li>
</ul>
<p>If you look at the “old school” t-tables, you will note that the T table is presented differently to the tables you have encountered before for the binomial, Poisson and normal distribution. Here the values in the body of the table are critical values from the T distribution rather than cumulative probabilities (as was the case for the tables for the other distributions). The same information is still available, just in a more restricted format.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tdist.png" class="img-fluid figure-img"></p>
<figcaption>Fig. Comparing the shapes of the Student’s T and the Z curves.</figcaption>
</figure>
</div>
</section>
<section id="t-based-confidence-interval" class="level3">
<h3 class="anchored" data-anchor-id="t-based-confidence-interval">T-Based Confidence Interval</h3>
<p>The general formula for a CI for <span class="math inline">\(\mu\)</span> when <span class="math inline">\(\sigma\)</span> is not known is</p>
<p><span class="math inline">\(\text{95 % CI} = \bar{y} \pm t^{\alpha/2}_{n-1} \times s.e.(\bar y)\)</span></p>
<p>Here <span class="math inline">\(\alpha\)</span> is the level of significance (or the probability of being incorrect in our estimation that we are willing to bear). For a 95% confidence interval, the corresponding level of significance is 5% (usually expressed in decimal format as 0.05). Also <span class="math inline">\(n-1\)</span> is the degrees of freedom. For example, the critical value <span class="math inline">\(t^{\alpha/2}_{n-1}\)</span> (or more simply t^{0.025}_{24}) is equal to 2.064.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="fl">0.025</span>, <span class="dv">24</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that s.e., s.e.(<span class="math inline">\(\bar y\)</span>) and s.e.m. are all equivalent expressions for the standard error of the mean. You will see them used interchangeably among scientists and the literature they write. Remember that the s.e. in the more common case when <span class="math inline">\(\sigma\)</span> is unknown is calculated as <span class="math inline">\(\frac{s}{\sqrt(n)}\)</span>.</p>
</section>
</section>
<section id="what-is-meant-by-confidence-interval" class="level2">
<h2 class="anchored" data-anchor-id="what-is-meant-by-confidence-interval">What is meant by confidence interval?</h2>
<p>If an experiment were to be repeated many times, on average, 95% of all 95% confidence intervals would include the true mean, <span class="math inline">\(\mu\)</span>.</p>
<p>The following graph shows 100 confidence intervals produced from computer simulated data. The simulated data are 100 studies, each containing n = 6 observations of a fictitious toxic substance concentration (<span class="math inline">\(\mu g/L\)</span>) assumed to be <span class="math inline">\(N(0.3, 0.1^2)\)</span>.</p>
<p>For each computer generated “sample”, the sample mean <span class="math inline">\(\mu\)</span> and standard deviation (s) are calculated, then the 95% confidence interval calculated <span class="math inline">\(\bar{y} \pm t^{\alpha/2}_{n-1} \times \sqrt{s^2/n}\)</span> .</p>
<p><img src="images/CI_sim.png" class="img-fluid" alt="Fig. Depiction of confidence intervals from each of 100 simulated samples."> Approximately 95% of these simulated samples have a confidence interval that includes the true value of 0.3 <span class="math inline">\(\mu g/L\)</span>. In the graph above, a confidence interval includes the true mean value of 0.3 if the vertical line (representing the width of the CI) crosses the horizontal line.</p>
<p>However in practice, when we calculate a CI from a single sample of data, we do not know if it is a confidence that includes <span class="math inline">\(\mu\)</span>, but we are 95% confident that it does! 99% confidence intervals would be wider and more likely to include <span class="math inline">\(\mu\)</span>, so it seems more logical to opt for the widest confidence interval possible. However, as we will learn in the next Section, there are opposing errors that are introduced when we make <span class="math inline">\(\alpha\)</span> small i.e.&nbsp;when we make the CI wide.</p>
</section>
<section id="data-transformation-and-the-lognormal-distribution" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-and-the-lognormal-distribution">Data Transformation and the Lognormal Distribution</h2>
<p>As you know, data are not always normally distributed. However, the most common statistical techniques assume normality of data. In situations where you wish to use one of these techniques (and the data are not normally distributed) a “transformation” is required.</p>
<p>The most common transformation in environmental modelling is the logarithm (to base 10 or base e). Other common transformations include the square root and arcsine (or angular) transformations.</p>
<p>The process of transformation is that each of the data values has the same mathematical function applied to them. For example,</p>
<p>Square root: <span class="math inline">\(y`=\sqrt{y}\)</span> or <span class="math inline">\(y`=\sqrt{y+ \frac{1}{2}}\)</span></p>
<p>Logarithmic: <span class="math inline">\(y`=\log_e y\)</span> or <span class="math inline">\(y`=\log_e (y+1)\)</span></p>
<p>Arcsine (angular) for a percentage <span class="math inline">\(p(0 &lt;p &lt; 100)\)</span>:</p>
<p><span class="math inline">\(x = (180/\pi) \times \arcsin(\sqrt{p/100})\)</span></p>
<p>The log transformation is often used in growth studies involving a continuous variable such as length or weight. This transformation is also useful in ecological studies involving counts of individuals when the variance of the sample count data is larger than the mean. If the sample data contain the value zero, then a modification to the <span class="math inline">\(\log(x)\)</span> transformation is the <span class="math inline">\(\log (x+1)\)</span> transformation. This transformation eliminates the mathematical difficulty that the logarithm of 0 is undefined. The square root transformation is useful when the variance of the sample data is approximately equal to the sample mean. The arcsine transformation is appropriate for data which are expressed as proportions.</p>
<p>After the data has been transformed, all subsequent analyses take place on the transformed scale. Results may be back-transformed to original scale.</p>
<p>The following examples show how to select the optimum transformation of data.</p>
<p><strong>Example 1:</strong> Number of blood cells observed in 400 areas on a microscope slide (haemocytometer) (Fisher, 1990 p56)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 39%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Number of blood cells:</th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">2</th>
<th style="text-align: left;">3</th>
<th style="text-align: left;">4</th>
<th style="text-align: left;">5</th>
<th style="text-align: left;">6</th>
<th style="text-align: left;">7</th>
<th style="text-align: left;">8</th>
<th style="text-align: left;">9</th>
<th style="text-align: left;">10</th>
<th style="text-align: left;">11</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Frequency:</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">43</td>
<td style="text-align: left;">53</td>
<td style="text-align: left;">86</td>
<td style="text-align: left;">70</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">37</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">2</td>
</tr>
</tbody>
</table>
<p><strong>Question:</strong> Can we assume this data follows a normal distribution?</p>
<p>#q: use ggplot to draw histogram, boxplot and qqnormal plot of the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>bcc_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"BloodCellCount.csv"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bcc_df, <span class="fu">aes</span>(BloodCellCount)) <span class="sc">+</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histogram of blood cell counts"</span>, <span class="at">x=</span><span class="st">"Number of blood cells"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bcc_df, <span class="fu">aes</span>(BloodCellCount)) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Boxplot of blood cell counts"</span>, <span class="at">x=</span><span class="st">"Number of blood cells"</span>, <span class="at">y=</span><span class="st">""</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bcc_df, <span class="fu">aes</span>(<span class="at">sample=</span>BloodCellCount)) <span class="sc">+</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"QQ plot of blood cells"</span>, <span class="at">x=</span><span class="st">"Theoretical quantiles"</span>, <span class="at">y=</span><span class="st">"Sample quantiles"</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(bcc_df<span class="sc">$</span>BloodCellCount)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(bcc_df<span class="sc">$</span>BloodCellCount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(bcc_df<span class="sc">$</span>BloodCellCount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observations:</p>
<ul>
<li>This is count data. From statistical theory, we don’t expect this data to follow a normal distribution (since it is discrete data, and the normal distribution is continuous).</li>
<li>The histogram and boxplot show that the data has a long tail to the right (appears positively skewed).</li>
<li>The skewness and kurtosis values differ from zero.</li>
<li>The formal normality test indicates that the null hypothesis of the data following a normal distribution should be rejected.</li>
</ul>
<p>Conclusion:</p>
<ul>
<li>We cannot assume this data follows a normal distribution. Distribution is POSITIVELY skewed.</li>
</ul>
<p>Question: Is there any transformation we can perform (that is fit a mathematical function to the data) where the data (on the transformed scale) will approximately follow a normal distribution?</p>
<p><em>A. Square Root Transformation</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>bcc_df<span class="sc">$</span>sqrt_BloodCellCount <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(bcc_df<span class="sc">$</span>BloodCellCount)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bcc_df, <span class="fu">aes</span>(sqrt_BloodCellCount)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histogram of blood cell counts"</span>, <span class="at">x=</span><span class="st">"Transformed Number of blood cells"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bcc_df, <span class="fu">aes</span>(sqrt_BloodCellCount)) <span class="sc">+</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Boxplot of blood cell counts"</span>, <span class="at">x=</span><span class="st">"Transformed Number of blood cells"</span>, <span class="at">y=</span><span class="st">""</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bcc_df, <span class="fu">aes</span>(<span class="at">sample=</span>sqrt_BloodCellCount)) <span class="sc">+</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"QQ plot of blood cells"</span>, <span class="at">x=</span><span class="st">"Theoretical quantiles"</span>, <span class="at">y=</span><span class="st">"Sample quantiles"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(bcc_df<span class="sc">$</span>sqrt_BloodCellCount)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(bcc_df<span class="sc">$</span>sqrt_BloodCellCount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(bcc_df<span class="sc">$</span>sqrt_BloodCellCount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In spite of the fact that the Shapiro Wilks test shows this distribution is significantly different to normal the normal probability plot shows a sufficiently linear match and the histogram appears symmetric. The distribution is symmetric, transformation successful.The test is significant, but the Q-Q plot and histogram look good. The skewness and kurtosis values are close to zero.</p>
<p><strong>Note:</strong> The Shapiro Wilks Test is very sensitive to large sample sizes, i.e.&nbsp;n &gt; 50. In this case we use the Q-Q plot and histogram to assess normality.</p>
<p><em>A. Log Transformation</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bcc_df<span class="sc">$</span>log_BloodCellCount <span class="ot">&lt;-</span> <span class="fu">log</span>(bcc_df<span class="sc">$</span>BloodCellCount)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bcc_df, <span class="fu">aes</span>(log_BloodCellCount)) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histogram of blood cell counts"</span>, <span class="at">x=</span><span class="st">"Transformed Number of blood cells"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bcc_df, <span class="fu">aes</span>(log_BloodCellCount)) <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Boxplot of blood cell counts"</span>, <span class="at">x=</span><span class="st">"Transformed Number of blood cells"</span>, <span class="at">y=</span><span class="st">""</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bcc_df, <span class="fu">aes</span>(<span class="at">sample=</span>log_BloodCellCount)) <span class="sc">+</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"QQ plot of blood cells"</span>, <span class="at">x=</span><span class="st">"Theoretical quantiles"</span>, <span class="at">y=</span><span class="st">"Sample quantiles"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(bcc_df<span class="sc">$</span>log_BloodCellCount)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(bcc_df<span class="sc">$</span>log_BloodCellCount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(bcc_df<span class="sc">$</span>log_BloodCellCount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Transformation is <strong>TOO STRONG</strong> - outlier(s) on left hand tail.</p>
<p><strong>Example 2:</strong> Tetrachlorobenzene levels (TcCB, ppb) in 100 soil samples</p>
<p>Note: We have seen previously that the distribution of this data is HIGHLY POSITIVELY skewed. Data is stored in the file TcCB.csv.</p>
<p><em>A. Square root transformation</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tccb_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"TcCB.csv"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>tccb_df<span class="sc">$</span>sqrt_TcCB_ppb <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(tccb_df<span class="sc">$</span>TcCB_ppb)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tccb_df, <span class="fu">aes</span>(sqrt_TcCB_ppb)) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histogram of TcCB concentration (ppb)"</span>, <span class="at">x=</span><span class="st">"Transformed TcCB"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tccb_df, <span class="fu">aes</span>(sqrt_TcCB_ppb)) <span class="sc">+</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Boxplot of TcCB concentration (ppb)"</span>, <span class="at">x=</span><span class="st">"Transformed TcCB"</span>, <span class="at">y=</span><span class="st">""</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tccb_df, <span class="fu">aes</span>(<span class="at">sample=</span>sqrt_TcCB_ppb)) <span class="sc">+</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"QQ plot of TcCB concentration (ppb)"</span>, <span class="at">x=</span><span class="st">"Theoretical quantiles"</span>, <span class="at">y=</span><span class="st">"Sample quantiles"</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(tccb_df<span class="sc">$</span>sqrt_TcCB_ppb)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(tccb_df<span class="sc">$</span>sqrt_TcCB_ppb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tccb_df<span class="sc">$</span>sqrt_TcCB_ppb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Transformation not powerful enough - still Positively Skewed</p>
<p><em>A. Log transformation</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tccb_df<span class="sc">$</span>log_TcCB_ppb <span class="ot">&lt;-</span> <span class="fu">log</span>(tccb_df<span class="sc">$</span>TcCB_ppb)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tccb_df, <span class="fu">aes</span>(log_TcCB_ppb)) <span class="sc">+</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histogram of TcCB concentration (ppb)"</span>, <span class="at">x=</span><span class="st">"Transformed TcCB"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tccb_df, <span class="fu">aes</span>(log_TcCB_ppb)) <span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Boxplot of TcCB concentration (ppb)"</span>, <span class="at">x=</span><span class="st">"Transformed TcCB"</span>, <span class="at">y=</span><span class="st">""</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tccb_df, <span class="fu">aes</span>(<span class="at">sample=</span>log_TcCB_ppb)) <span class="sc">+</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"QQ plot of TcCB concentration (ppb)"</span>, <span class="at">x=</span><span class="st">"Theoretical quantiles"</span>, <span class="at">y=</span><span class="st">"Sample quantiles"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(tccb_df<span class="sc">$</span>log_TcCB_ppb)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(tccb_df<span class="sc">$</span>log_TcCB_ppb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tccb_df<span class="sc">$</span>log_TcCB_ppb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Transformation successful - symmetric distribution</p>
<section id="the-natural-log-log_e-transformation" class="level3">
<h3 class="anchored" data-anchor-id="the-natural-log-log_e-transformation">The Natural Log (<span class="math inline">\(\log_e\)</span>) Transformation</h3>
<p>Continuing on from Example 2 where the transformation chosen is <span class="math inline">\(log_e\)</span>, we see that the normal probability plot is approximately linear and all test statistics (for the normality tests) are lower than their corresponding critical values, so we can assume the log-transformed data are normally distributed. (Or equivalently that the original data are log-normally distributed.)</p>
<p>On the log scale, the mean is –0.598. So the back-transformed mean is <span class="math inline">\(e^{–0.598} = 0.550\)</span> ppb.</p>
<p>When a log-transformation is used, the back-transformed mean is known as the geometric mean (as opposed to the ordinary arithmetic mean). This measure is commonly used in describing environmental data, as in many cases data are highly positively skewed. Like the median, the geometric mean is less sensitive (or more robust) to these outlying values.</p>
<p>Note that the geometric mean is usually defined as</p>
<p><span class="math inline">\(GM = \left( y_1 \times y_2 \times \ldots \times y_n \right)^{\frac{1}{n}} = \left( \prod_{i=1}^{n} y_i \right)^{\frac{1}{n}}\)</span></p>
<p>which is the same as <span class="math inline">\(\exp(\bar {y`})\)</span> where <span class="math inline">\(\bar{y}^{\prime} = \frac{1}{n} \sum_{i=1}^{n} y_i^{\prime}\)</span> and <span class="math inline">\(y_i^{\prime} = \log y_i\)</span>.</p>
<p>This can be shown for a simple case involving n = 3 observations:</p>
<p><span class="math inline">\(\exp(\bar {y^{\prime}}) = \exp\left[\frac{1}{3}(y^{\prime}_1 + y^{\prime}_2 + y^{\prime}_3)\right]\)</span></p>
<p><span class="math inline">\(\exp\left[\frac{1}{3}(\log y_1 + \log y_2 + \log y_3)\right]\)</span> <span class="math inline">\(y^{\prime}_i = \log y_i\)</span></p>
<p><span class="math inline">\(\left[\exp(\log y_1 + \log y_2 + \log y_3)\right]^{\frac{1}{3}}\)</span> <span class="math inline">\(e^{ab}=(e^a)^b = (e^b)^a\)</span></p>
<p><span class="math inline">\(\left[\exp(\log y_1) \times \exp(\log y_2) \times \exp(\log y_3)\right]^{\frac{1}{3}}\)</span> <span class="math inline">\(e^{a+b} = e^a \times e^b\)</span></p>
<p><span class="math inline">\(\left[y_1 \times y_2 \times y_3\right]^{\frac{1}{3}} = \sqrt[3]{y_1 \times y_2 \times y_3}\)</span> <span class="math inline">\(e^{\log a} = a\)</span> <span class="math inline">\(= GM\)</span></p>
<p>Just as the geometric mean is calculated as <span class="math inline">\(\exp(\bar {y^{\prime}})\)</span>, some books refer to <span class="math inline">\(exp(s^{\prime})\)</span> as the geometric standard deviation, where <span class="math inline">\(s^{\prime}\)</span> is the standard deviation of the <span class="math inline">\(y_i^{\prime} = \log y_i\)</span>. However, this is not a very useful concept, so it won’t be used here.</p>
<p>Since we have concluded log TcCB has a normal distribution, then TcCB has a <strong>lognormal distribution</strong>. If a variable log <span class="math inline">\(y = y{\prime}\)</span> has a normal <span class="math inline">\(N(\mu,\sigma^2)\)</span> distribution, then the original variable has a lognormal distribution with parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>, <span class="math inline">\(y \sim LN(\mu,\sigma^2)\)</span>. Note that <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> are the parameters for the log variable. It can be shown (no proof here) the mean and variance for the lognormal <span class="math inline">\(y \sim LN(\mu,\sigma^2)\)</span>. distribution are</p>
<ul>
<li>Mean = <span class="math inline">\(exp(\mu+1/2\sigma^2)\)</span></li>
<li>Variance = <span class="math inline">\(exp(2\mu+\sigma^2)[exp(\sigma^2)-1]\)</span></li>
</ul>
<p>We can illustrate these relationships by using the parameter estimates <span class="math inline">\(\hat \mu=-0.598\)</span> and <span class="math inline">\(\hat \sigma=1.362\)</span> from the log TcCB data to produce the following fitted normal distributions and lognormal distributions are obtained:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lognormal.png" class="img-fluid figure-img"></p>
<figcaption>Fig. Normal and Log Normal distributions for TcCB data</figcaption>
</figure>
</div>
<p>Also, using these parameter estimates, the mean and variance of the lognormal distribution are</p>
<ul>
<li>Mean = <span class="math inline">\(exp(-0.598+1/2\times 1.362^2)=1.390\)</span> ppb</li>
<li>Variance = <span class="math inline">\(exp(2\times -0.598+1.362^2)[exp(1.362^2)-1]=10.442\)</span> ppb</li>
<li>Std. Dev = <span class="math inline">\(\sqrt{\text{variance}} = \sqrt{10.422} = 3.228\)</span> ppb,</li>
</ul>
<p>where -0.598 is the average of the logged data and 1.363 is the standard deviation of the logged data.</p>
<p>Note the similarity of these to the sample mean (1.412) and sample standard deviation (3.098) of the raw TcCB data.</p>
</section>
</section>
<section id="hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis testing</h2>
<p>Sometimes research questions are framed not as “What is a plausible range of values for such and such a parameter?” but rather “Are the data consistent with this particular value for the parameter?”. A hypothesis test is a test of such a hypothesised value. For example, we may simply wish to test whether the population mean yield of wheat in a particular region is 2 tons per hectare or not.</p>
<p>Statistical hypothesis tests are based on research questions and hypotheses. Some examples of research questions are:</p>
<ul>
<li>Does an increased use of fertilisers of farms in a catchment area result in increased river pollution?</li>
<li>How do different crop residue management systems affect the “health” of the soil?</li>
<li>What effect will selective logging have on wildlife populations?</li>
</ul>
<p>The diagram below also appears in Section 1. Here we see where statistical hypothesis testing fits into the research process at the point of <strong>statistical analysis</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/research_cycle.png" class="img-fluid figure-img"></p>
<figcaption>Fig. The research process</figcaption>
</figure>
</div>
<section id="steps-in-hypothesis-testing-via-a-test-statistic" class="level3">
<h3 class="anchored" data-anchor-id="steps-in-hypothesis-testing-via-a-test-statistic">Steps in Hypothesis Testing (via a Test Statistic)</h3>
<ol type="1">
<li>Choose the level of significance, <span class="math inline">\(\alpha\)</span> (most commonly <span class="math inline">\(\alpha= 0.05\)</span>, but you will also see 0.01 and 0.10 mentioned regularly)</li>
<li>Write the null and alternate hypotheses</li>
<li>Check if the assumptions of the test hold (if they don’t - choose an appropriate transformation or choose another test!)</li>
<li>Calculate the test statistic (&amp; degrees of freedom if applicable)</li>
<li><ol type="a">
<li>Obtain a P-value <strong>OR</strong></li>
<li>Obtain critical values</li>
</ol></li>
<li>Make a statistical conclusion by
<ol type="a">
<li>Comparing this P-value to your chosen level of significance (if <span class="math inline">\(P &lt; \alpha\)</span>, then reject null hypothesis) <strong>OR</strong></li>
<li>Seeing if the test statistic lies with the rejection region</li>
</ol></li>
<li>Write a biological conclusion</li>
</ol>
</section>
<section id="one-tailed-and-two-tailed-tests" class="level3">
<h3 class="anchored" data-anchor-id="one-tailed-and-two-tailed-tests">One-Tailed and Two-Tailed Tests</h3>
<p>Hypothesis tests about the population mean can take one of the three forms:</p>
<ol type="a">
<li><span class="math inline">\(H_0: \mu = c\)</span> or <span class="math inline">\(H_1: \ne c\)</span><br>
</li>
<li><span class="math inline">\(H_0: \mu \ge c\)</span> or <span class="math inline">\(H_1: \mu &lt; c\)</span><br>
</li>
<li><span class="math inline">\(H_0: \mu \le c\)</span> or <span class="math inline">\(H_1: \mu &gt; c\)</span></li>
</ol>
<p>where <span class="math inline">\(c\)</span> is a real number chosen before the data are gathered. Each <span class="math inline">\(H_0\)</span> above is tested with a test statistic, and the decision about <span class="math inline">\(H_0\)</span> is based on how far this test statistics deviates from expectation under a true <span class="math inline">\(H_0\)</span>. If the test statistic exceeds the critical value(s), <span class="math inline">\(H_0\)</span> is rejected. Alternatively, if the <span class="math inline">\(P\)</span> value for the test statistic is smaller than the predetermined alpha level, <span class="math inline">\(H_0\)</span> is rejected.</p>
<p>For any particular experiment only one of the sets of hypotheses is appropriate and can be tested. <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> are predictions that follow naturally from the question posed and the result anticipated by the researcher. Also, hypotheses contain only parameters (Greek letters) and claimed values, never numbers that come from the sample itself. <span class="math inline">\(H_0\)</span> always contains the equal sign and is the hypothesis that is examined by the test statistic.</p>
<p>Generally a) is the form of hypothesis test that we employ. Options b) or c) are used occasionally when we have evidence (quite independent of the data we have collected) to believe that the difference of the hypothesized value from the true population mean, if any, is in one direction only. Note that a one tailed test is NOT appropriate simply because the difference between the samples is clearly in one direction or the other.</p>
</section>
<section id="type-i-and-type-ii-errors" class="level3">
<h3 class="anchored" data-anchor-id="type-i-and-type-ii-errors">Type I and Type II Errors</h3>
<p>A Type I error (false positive) is made when we reject the null hypothesis when it is true. We might for example declare that a population mean is different from hypothesized value when, in fact, they are not. Equally we may err in the other direction, that is, we may accept a null hypothesis when it is false. We might, for example, fail to detect a difference between the population mean and a hypothesized value. In doing so, we make a Type II error (false negative). The definitions of each of these two errors is summarised in the table below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/error.png" class="img-fluid figure-img"></p>
<figcaption>Fig. Type I and Type II Error</figcaption>
</figure>
</div>
<p>Because , the level of significance, is chosen by the experimenter, it is under the control of the experimenter and it is known. When you reject and <span class="math inline">\(H_0\)</span>, therefore, you know the probability of an error (Type I). If you accept an <span class="math inline">\(H_0\)</span> it is much more difficult to ascertain the probability of an error (Type II). This is because Type II errors depend on many factors, some of which may be unknown to the experimenter. So the rejection of <span class="math inline">\(H_0\)</span> leads to the more satisfying situation because the probability of a mistake is easily quantifiable.</p>
<p>You may think that if the level of significance is the probability of a Type I error and is under our control, why not make the level of significance (<span class="math inline">\(\alpha\)</span> level) very small to eliminate or reduce Type I errors? Why not use 1 in 100 or 1 in 1000? Sometimes we may wish to do that (e.g.&nbsp;in human medical trials), but reduction of the <span class="math inline">\(\alpha\)</span> level (Type I error) always increases the probability of a Type II error.</p>
<p>You can read more about this in Chapter 5 of Glover &amp; Mitchell (2008) or Chapter 5 of Clewer &amp; Scarisbrick (2013).</p>
<p><em>Glover, T. and Mitchell, K., 2008. An introduction to biostatistics. Waveland Press.</em></p>
<p><em>Clewer, A.G. and Scarisbrick, D.H., 2013. Practical statistics and experimental design for plant and crop science. John Wiley &amp; Sons.</em></p>
</section>
<section id="power-of-the-test" class="level3">
<h3 class="anchored" data-anchor-id="power-of-the-test">Power of the Test</h3>
<p>Ideally, a test of significance should reject the null hypothesis when it is false. Power is the probability of rejecting <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is false, <span class="math inline">\(1-\beta\)</span>. A test becomes more powerful as the available data increases.</p>
<p>You’ll do more on this topic (including planning experiments and interpreting statistical differences in light of biological importance NEXT YEAR).</p>
</section>
</section>
<section id="one-sample-z-tests" class="level2">
<h2 class="anchored" data-anchor-id="one-sample-z-tests">One-Sample z-Tests</h2>
<section id="introductory-example" class="level3">
<h3 class="anchored" data-anchor-id="introductory-example">Introductory Example</h3>
<p>The liquid effluent from a chemical manufacturing plant is to be evaluated. The plant operators claim the mean concentration of a specific toxic substance is 0.3 <span class="math inline">\(\mu g/l\)</span>.</p>
<p>Let y = toxic substance concentration (<span class="math inline">\(\mu g/l\)</span>). Assume data are normally distributed: <span class="math inline">\(y \sim N(\mu, \sigma^2)\)</span>. Suppose (for the time being) we have prior information on the variability of similar operating plants, and can assume that <span class="math inline">\(\sigma = 0.1\)</span> <span class="math inline">\(\mu g/l\)</span>. Assume that the claim is true, i.e.&nbsp;(population) mean is <span class="math inline">\(\mu g/l\)</span>.</p>
<p><strong>Scenario A</strong></p>
<p>To test this claim, a single sample of effluent discharge was taken and found to be 0.4 <span class="math inline">\(\mu g/l\)</span>. Does the data support their claim?</p>
<p>We want to see how likely it is to get an observation of 0.4 <span class="math inline">\(\mu g/l\)</span>, or something even more extreme. By more extreme, we mean &gt; 0.4 <span class="math inline">\(\mu g/l\)</span>, or &lt; 0.2 <span class="math inline">\(\mu g/l\)</span> (i.e.&nbsp;more than 0.1 <span class="math inline">\(\mu g/l\)</span> away from <span class="math inline">\(\mu = 0.3\)</span>, in either direction). This probability is represented in the sketch below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.3</span><span class="dv">-4</span><span class="sc">*</span><span class="fl">0.1</span>, <span class="fl">0.3</span><span class="sc">+</span><span class="dv">4</span><span class="sc">*</span><span class="fl">0.1</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.3</span>, <span class="at">sd =</span> <span class="fl">0.1</span>), <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.3</span>, <span class="at">sd=</span><span class="fl">0.1</span>), </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.3</span><span class="dv">-4</span><span class="sc">*</span><span class="fl">0.1</span>, <span class="fl">0.2</span>), <span class="at">geom =</span> <span class="st">"area"</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.3</span>, <span class="at">sd=</span><span class="fl">0.1</span>), </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.3</span><span class="sc">+</span><span class="dv">4</span><span class="sc">*</span><span class="fl">0.1</span>, <span class="fl">0.4</span>), <span class="at">geom =</span> <span class="st">"area"</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">N</span>(<span class="fl">0.3</span>,<span class="fl">0.1</span><span class="sc">^</span><span class="dv">2</span>)<span class="sc">~</span>pdf)) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So the probability of this event is</p>
<p><span class="math inline">\(P(Y&lt;0.2 \text{ or } Y&gt;0.4)\)</span> <span class="math inline">\(=\left( Z&lt;\frac{0.2-0.3}{0.1} \text{ or } Z&gt;\frac{0.4-0.3}{0.1} \right)\)</span> <span class="math inline">\(=P(Z&lt;-1 \text{ or } Z&gt;1)\)</span> <span class="math inline">\(=2 \times P(Z&lt;-1)\)</span> <span class="math inline">\(=2 \times 0.1587 = 0.3174\)</span></p>
<p>This is a large probability (<span class="math inline">\(\approx\)</span> 1 in 3), so obtaining a value of 0.4 <span class="math inline">\(\mu g/l\)</span> is not inconsistent with <span class="math inline">\(\mu = 0.3\)</span> <span class="math inline">\(\mu g/l\)</span>. There is no reason to reject the hypothesis that the (population) mean is <span class="math inline">\(\mu = 0.3\)</span> <span class="math inline">\(\mu g/l\)</span>.</p>
<p><em>Scenario B</em></p>
<p>Suppose now that the toxic substance concentration was 0.5 <span class="math inline">\(\mu g/l\)</span>. What is the conclusion now?</p>
<p>We now need the probability of &gt; 0.5 <span class="math inline">\(\mu g/l\)</span>, or &lt; 0.1 <span class="math inline">\(\mu g/l\)</span>. This is represented in the sketch below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.3</span><span class="dv">-4</span><span class="sc">*</span><span class="fl">0.1</span>, <span class="fl">0.3</span><span class="sc">+</span><span class="dv">4</span><span class="sc">*</span><span class="fl">0.1</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.3</span>, <span class="at">sd =</span> <span class="fl">0.1</span>), <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.3</span>, <span class="at">sd=</span><span class="fl">0.1</span>), </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.3</span><span class="dv">-4</span><span class="sc">*</span><span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="at">geom =</span> <span class="st">"area"</span>, </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">0.3</span>, <span class="at">sd=</span><span class="fl">0.1</span>), </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.3</span><span class="sc">+</span><span class="dv">4</span><span class="sc">*</span><span class="fl">0.1</span>, <span class="fl">0.5</span>), <span class="at">geom =</span> <span class="st">"area"</span>, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">N</span>(<span class="fl">0.3</span>,<span class="fl">0.1</span><span class="sc">^</span><span class="dv">2</span>)<span class="sc">~</span>pdf)) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So the probability of this event is</p>
<p><span class="math inline">\(P(Y&lt;0.1 \text{ or } Y&gt;0.5)\)</span> <span class="math inline">\(=\left( Z&lt;\frac{0.1-0.3}{0.1} \text{ or } Z&gt;\frac{0.5-0.3}{0.1} \right)\)</span> <span class="math inline">\(=P(Z&lt;-2 \text{ or } Z&gt;2)\)</span> <span class="math inline">\(=2 \times P(Z&lt;-2)\)</span> <span class="math inline">\(=2 \times 0.0228 = 0.0456\)</span></p>
<p>This is small (less than 1 in 20), so obtaining a concentration of 0.5 <span class="math inline">\(\mu g/l\)</span> is unlikely, if <span class="math inline">\(\mu = 0.3\)</span> <span class="math inline">\(\mu g/l\)</span>.</p>
<p>So we reject the hypothesis that <span class="math inline">\(\mu = 0.5\)</span> <span class="math inline">\(\mu g/l\)</span> and conclude that the (population) mean is significantly higher than 0.3 <span class="math inline">\(\mu g/l\)</span>.</p>
<p>HOWEVER, in reality you would <strong>NOT</strong> make a recommendation based on this conclusion as it is based on a single value! You want to base your decision on a much larger sample.</p>
<p><em>Scenario C</em></p>
<p>Continuing the liquid effluent example, recall the plant operators claim the mean concentration of a specific toxic substance is 0.3 <span class="math inline">\(\mu g/l\)</span>. Now let’s say that to test this claim, six effluent discharge samples were taken at randomly chosen times and the resultant readings were 0.48 0.25 0.29 0.51 0.49 0.40. Does the data support their claim?</p>
<p>Let y = toxic substance concentration (<span class="math inline">\(\mu g/l\)</span>). Assume data are normally distributed: <span class="math inline">\(y \sim N(\mu, \sigma^2)\)</span>. Suppose (for the time being) we have prior information on the variability of similar operating plants, and can assume that <span class="math inline">\(\sigma = 0.1\)</span> <span class="math inline">\(\mu g/l\)</span>. As we know the population standard deviation, <span class="math inline">\(\sigma\)</span>, we will use a z-test.</p>
<p>Null hypothesis: <span class="math inline">\(H_0: \mu = 0.3\)</span> <span class="math inline">\(\mu g/l\)</span> Alternate hypothesis: <span class="math inline">\(H_1: \mu \ne 0.3\)</span> <span class="math inline">\(\mu g/l\)</span> where <span class="math inline">\(\mu\)</span> = mean toxic substance concentration</p>
<p><span class="math inline">\(z=\frac{\bar{y}-\mu}{\sqrt{\sigma^2/n}}=\frac{\bar{y}-\mu}{se(\bar{y})}\)</span></p>
<pre><code>Test Statistic,  </code></pre>
<p><span class="math inline">\(z=\frac{0.403-0.3}{\sqrt{0.1^2/6}}=2.53\)</span></p>
<p>Assuming that the null hypothesis is true (that <span class="math inline">\(\mu = 0.3\)</span> <span class="math inline">\(\mu g/l\)</span>), then z = 2.53 is an observation from a standard normal distribution.</p>
<p>We now calculate the probability of obtaining this z-value, or something more extreme. This is the P value of the test:</p>
<p><span class="math inline">\(P=P(\bar{y} \le 0.197 \text{ or } \bar{y} \ge 0.403)\)</span><br>
<span class="math inline">\(=P(Z \le -2.53 \text{ or } Z \ge 2.53)\)</span> <span class="math inline">\(=2 \times P(Z \le -2.53)\)</span> <span class="math inline">\(=2 \times 0.0057=0.011\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">2.53</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/zvals.png" class="img-fluid figure-img"></p>
<figcaption>plot of <span class="math inline">\(P(\bar{y} \le 0.197 \text{ or } \bar{y} \ge 0.403)\)</span> and <span class="math inline">\(P(Z \le -2.53 \text{ or } \bar{y} \ge 2.53)\)</span></figcaption>
</figure>
</div>
<p>If <span class="math inline">\(H_0\)</span> is true, there is only a 1.1% chance of obtaining this value of or something more extreme. This is unlikely, so we <strong>reject the null hypothesis</strong>. Hence we conclude that the toxic substance concentration in the effluent has a mean <strong>significantly greater</strong> than 0.3 <span class="math inline">\(\mu g/l\)</span>.</p>
</section>
</section>
<section id="general-notes-on-hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="general-notes-on-hypothesis-testing">General Notes on Hypothesis Testing</h2>
<p>Often researchers choose their level of significance (<span class="math inline">\(\alpha\)</span>) as 0.05. In that case…</p>
<ul>
<li>If <span class="math inline">\(P&lt;0.05\)</span> (less than 1 in 20) <span class="math inline">\(\Rightarrow\)</span> reject <span class="math inline">\(H_0\)</span></li>
<li>If <span class="math inline">\(P&lt;0.05\)</span> (more than 1 in 20) <span class="math inline">\(\Rightarrow\)</span> retain <span class="math inline">\(H_0\)</span></li>
</ul>
<p>If <span class="math inline">\(H_0\)</span> is retained, this does not necessarily mean that <span class="math inline">\(H_0\)</span> is true; the sample may be too small to detect a difference.</p>
<p>Even though <span class="math inline">\(H_0\)</span> might be rejected, there is a small chance that this will be in error. If you use a 5% cut off rule, 5% of your conclusions will be wrong when <span class="math inline">\(H_0\)</span> is true!</p>
</section>
<section id="one-sample-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="one-sample-t-tests">One-Sample t-Tests</h2>
<section id="introductory-example-1" class="level3">
<h3 class="anchored" data-anchor-id="introductory-example-1">Introductory Example</h3>
<p>For the toxic substance concentration in effluent example (with the 6 readings), now we will not make any assumption about the variability (i.e.&nbsp;we assume we don’t know sigma). How would the analysis change?</p>
<p>As before the null and alternate hypotheses are, <span class="math inline">\(H_0: \mu = 0.3\)</span> <span class="math inline">\(\mu g/l\)</span> vs.&nbsp;<span class="math inline">\(H_1: \mu \ne 0.3\)</span> <span class="math inline">\(\mu g/l\)</span>. From the data we calculate the sample mean and sample standard deviation to use in the construction of the test statistic, t. Here, <span class="math inline">\(\mu=0.403\)</span> <span class="math inline">\(\mu g/l\)</span> and <span class="math inline">\(s = 0.111\)</span> <span class="math inline">\(\mu g/l\)</span>.</p>
<p>The test statistic, t, is calculated using the following formula:</p>
<p><span class="math inline">\(t=\frac{\bar{y}-\mu}{\sqrt{s^2/n}}=\frac{\bar{y}-\mu}{se(\bar{y})}\)</span></p>
<p>and the associated degrees of freedom as follows: degrees of freedom, <span class="math inline">\(df = n-1\)</span>.</p>
<p>So in the current example,</p>
<p><span class="math inline">\(t=\frac{0.403-0.3}{\sqrt{0.111^2/6}}=2.29\)</span> and <span class="math inline">\(df=6-1=5\)</span></p>
<p>Assuming that the null hypothesis is true (that <span class="math inline">\(\mu = 0.3\)</span> <span class="math inline">\(\mu g/l\)</span>), then t = 2.29 is now an observation from a t distribution with <span class="math inline">\(n - 1 = 5\)</span> degrees of freedom.</p>
<p>The P-value for this t-test is</p>
<p><span class="math inline">\(P=P(\bar{y} \le 0.197 \text{ or } \bar{y} \ge 0.403)\)</span><br>
<span class="math inline">\(=P(T_5 \le -2.29 \text{ or } T_5 \ge 2.29)\)</span> <span class="math inline">\(=2 \times P(T_5 \le -2.29)\)</span> <span class="math inline">\(=2 \times 0.035=0.071\)</span></p>
<p>We can look -2.29 up in the “old school” t-tables or we can use the <code>pt</code> function in R to calculate P.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fl">2.29</span>,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This time, the P-value is greater than 0.05, so we cannot reject <span class="math inline">\(H_0\)</span>. We can say that the data are consistent with the mean concentration of the toxic substance being 0.3 <span class="math inline">\(\mu g/l\)</span>.</p>
<p>Rather than calculate the probabilities by hand, we can use R’s <code>t.test</code> command to run the test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>toxic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.48</span>, <span class="fl">0.25</span>, <span class="fl">0.29</span>, <span class="fl">0.51</span>, <span class="fl">0.49</span>, <span class="fl">0.40</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(toxic, <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From the output we can see that we can see that</p>
<p>t = 2.2891; df = 5; p-value = 0.07073</p>
<p>Our conclusion is as above.</p>
</section>
<section id="general-notes-on-the-t-distribution" class="level3">
<h3 class="anchored" data-anchor-id="general-notes-on-the-t-distribution">General Notes on the T Distribution</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tdist_1.png" class="img-fluid figure-img"></p>
<figcaption>t distribution versus z distribution</figcaption>
</figure>
</div>
<p>The t distribution has “heavier” tails than the normal distribution.</p>
<p>As degrees of freedom <span class="math inline">\(\uparrow\)</span>, t <span class="math inline">\(\rightarrow\)</span> normal distribution.</p>
<p>The P-value for the t-test is larger than that for the z-test <span class="math inline">\(\therefore\)</span> the t-test is not as powerful. This is because some information must be used to estimate <span class="math inline">\(\sigma\)</span>.</p>
</section>
</section>
<section id="steps-in-hypothesis-testing-via-a-confidence-interval" class="level2">
<h2 class="anchored" data-anchor-id="steps-in-hypothesis-testing-via-a-confidence-interval">Steps in Hypothesis Testing (via a Confidence Interval)</h2>
<p>Hypothesis testing via a t-based confidence interval is an alternative to conducting a one-sample t-test (via test statistic, df, and P-value). The same assumptions apply as for a t-test.</p>
<ol type="1">
<li>Write the null and alternate hypotheses.</li>
<li>Check if the assumptions of the test hold.</li>
<li>Calculate the confidence interval.</li>
<li>Check whether the hypothesised value / mean lies within the confidence interval.</li>
<li>Make a statistical conclusion. (If the hypothesized value / mean does not lie within the confidence interval, reject the null hypothesis.)</li>
<li>Write a biological conclusion.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>toxic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.48</span>, <span class="fl">0.25</span>, <span class="fl">0.29</span>, <span class="fl">0.51</span>, <span class="fl">0.49</span>, <span class="fl">0.40</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(toxic, <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see that the 95% confidence intervals are also provided in the R output above and that our hypothesised mean of 0.3 <span class="math inline">\(\mu g/l\)</span> is contained within (between) the CI’s.</p>
<p>We conclude that the true mean toxic substance concentration does not differ significantly from 0.3 <span class="math inline">\(\mu g/l\)</span>, and that we are 95% confident that this unknown true mean value lies within the range 0.2873 to 0.5194 <span class="math inline">\(\mu g/l\)</span>.</p>
<p>Performing a hypothesis test using a 95% confidence interval is equivalent to performing a t-test with a 5% level of significance – the conclusions drawn will be the same. Similarly the conclusions from a 90% CI and a t-test with <span class="math inline">\(\mu = 0.10\)</span> will be the same. Some journals prefer us to report the CI’s as they are more informative than the p-value alone. For example, the width of the CI’s says something about the precision of the estimate.</p>
</section>
<section id="one-sample-t-test-with-data-transformation" class="level2">
<h2 class="anchored" data-anchor-id="one-sample-t-test-with-data-transformation">One-Sample t-Test with Data Transformation</h2>
<p><strong>Example</strong></p>
<p>There is evidence that total nitrogen levels in the river – like many other environmental quality data – are lognormally distributed. Consequently, it is more convenient to work on the logarithmic scale. For example,</p>
<pre><code>TN = log10[total nitrogen concentration]</code></pre>
<p>where the nitrogen concentration is measured in <span class="math inline">\(\mu g/l\)</span>. (Often scientists will find it more convenient to use the <span class="math inline">\(\log_{10}\)</span> scale rather than <span class="math inline">\(\log_e\)</span>, but this is of no real consequence).</p>
<p>Data from 29 observations of Total Nitrogen levels in the Nepean River @ Wallacia downloaded using Water NSW water insights API and can be found in the data set <code>TN_Wallacia.csv</code>. We are interested to test whether total nitrogen concentration differs significantly from the preferred water quality target of 500 ppb (note that ppm and <span class="math inline">\(\mu g/l\)</span> are equivalent). Nitrogen content would ideally be equal to or less than this target to reduce the risk of significant eutrophication.</p>
<p>Be sure to include the following elements in your statistical test:</p>
<ul>
<li>null and alternate hypotheses;</li>
<li>consideration of the analysis assumptions;</li>
<li>mean and confidence interval on the original measurement scale;</li>
<li>biological conclusion of the test output including the confidence interval.</li>
</ul>
<p><strong>Solution</strong></p>
<p>We wish to perform a one-sample t-test to test the null hypothesis <span class="math inline">\(H_0: \mu = 500\)</span> <span class="math inline">\(\mu g/l\)</span>. However to do this we need to be able to assume the data follows a normal distribution. A quick summary of the raw data shows that the data is skewed to the right (see boxplot below, also the mean of 855.9 <span class="math inline">\(\mu g/l\)</span> is greater than the median of 800 <span class="math inline">\(\mu g/l\)</span>) and we also see the typical “smiley” shape of the points on the qq normal plot. We also find that the skewness value of 1.10 is positive and greater than one. The Shapiro-Wilks normality test indicates non-normality at the 5% significance level (as the p-value &lt; 0.05).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>tn <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"TN_Wallacia.csv"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tn<span class="sc">$</span>TN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(tn<span class="sc">$</span>TN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tn<span class="sc">$</span>TN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tn, <span class="fu">aes</span>(<span class="at">sample =</span> TN)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="co"># This adds the QQ plot points</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span> <span class="co"># This adds the QQ line</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Normal Q-Q Plot"</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tn, <span class="fu">aes</span>(<span class="at">x=</span>TN)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Transform data</strong></p>
<p>A log (base 10) transformation on the raw data was performed as suggested.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tn<span class="sc">$</span>log10_TN <span class="ot">&lt;-</span> <span class="fu">log10</span>(tn<span class="sc">$</span>TN)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(tn<span class="sc">$</span>log10_TN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use the mean of this transformed data i.e.&nbsp;the mean transformed TN value (= 2.886528) to find the estimated geometric mean (GM) of the phosphorus levels. The <span class="math inline">\(GM = 10^2.886528 = 770.066\)</span> <span class="math inline">\(\mu g/l\)</span>. This is an indication of a typical phosphorus reading. Note how this is lower than the arithmetic mean.</p>
<p><strong>Recall</strong> from earlier that when a log-transformation is used, the back-transformed mean is known as the geometric mean (as opposed to the ordinary arithmetic mean). This measure is commonly used in describing environmental data, as in many cases data are highly positively skewed. Like the median, the geometric mean is less sensitive (or more robust) to these outlying values.</p>
<p>Again before proceeding with the t-test or obtaining a t-based CI, we need to perform a normal probability test on the log-transformed values, TP to test whether these log values can be assumed to follow a normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tn, <span class="fu">aes</span>(<span class="at">sample =</span> log10_TN)) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="co"># This adds the QQ plot points</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span> <span class="co"># This adds the QQ line</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Normal Q-Q Plot"</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(tn<span class="sc">$</span>log10_TN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Based on the qq-normal plot and the Shapiro Wilks test (p&gt;0.05), we can assume that the transformation has been successful.</p>
<p>We perform the t test on the log scale (using the newly generated data) where our null and alternate hypotheses are in effect:</p>
<ul>
<li><span class="math inline">\(H_0: \mu_A = log_{10} 500\)</span> <span class="math inline">\(mg/l\)</span></li>
<li><span class="math inline">\(H_1: \mu_A \ne log_{10} 500\)</span> <span class="math inline">\(mg/l\)</span></li>
</ul>
<p>where <span class="math inline">\(\mu_A\)</span> is the population arithmetic mean.</p>
<p>Hence the test statistic will be</p>
<p><span class="math inline">\(t=\frac{\bar{y} \text{ (of log10 data)}-\log_{10}(500)}{s \text{ (of log10 data)}/\sqrt{n}}\)</span> and <span class="math inline">\(df = n-1\)</span>.</p>
<p>Let’s test this in R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(tn<span class="sc">$</span>log10_TN, <span class="at">mu =</span> <span class="fu">log10</span>(<span class="dv">500</span>), <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The P-value of &lt;0.001 indicates that we should reject <span class="math inline">\(H_0\)</span>. R also produces the CI (2.807748, 2.965309) with its t-test output. Confirming the rejection of <span class="math inline">\(H_0\)</span> is the fact that the test mean of 2.69897 (<span class="math inline">\(log_{10}500\)</span>) lies outside (and below) these confidence limits. Therefore we can conclude that the (population) geometric mean phosphorus concentration is significantly higher than 500 <span class="math inline">\(\mu g/l\)</span> and is therefore exceeding the water quality target.</p>
<p>To obtain the 95% confidence interval for the geometric mean, we need to back transform both limits of the CI given by R (above) which are on the <span class="math inline">\(\log_{10}\)</span> scale. The 95% CI for the mean TN is 2.807748 to 2.965309. So the 95% CI for the geometric mean phosphorus level is <span class="math inline">\(10^{2.807748}\)</span> to <span class="math inline">\(10^{2.965309}\)</span>.</p>
<p>So the 95% CI for the geometric mean phosphorus level is 642.31 to 923.23 <span class="math inline">\(\mu g/l\)</span>. The best estimate of the true geometric mean is 770.066 <span class="math inline">\(\mu g/l\)</span>. However, the true value may be in the range 642.31 to 923.23 <span class="math inline">\(\mu g/l\)</span> with 95% certainty.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ENVX-resources\.github\.io\/ENVX1002-handbook\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>