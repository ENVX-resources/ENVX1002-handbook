{
  "hash": "130e8e82ed84164e5a89136ef22971c9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: The Central Limit Theorem\ndraft: true\n---\n\n\n\n\n\n\n## Overview\n\n\n\nThe Central Limit Theorem (CLT) is a fundamental concept in statistics that helps us understand the behaviour of sample means. In this chapter, we'll explore this concept using real ecological data, building on our knowledge of descriptive statistics and data visualisation.\n\n## Data Introduction\n\nWe'll work with the Konza Prairie LTER dataset (`knz_bison`), which contains bison weight measurements across different years:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(knz_bison)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 8,325\nColumns: 8\n$ data_code     <chr> \"CBH01\", \"CBH01\", \"CBH01\", \"CBH01\", \"CBH01\", \"CBH01\", \"C…\n$ rec_year      <dbl> 1994, 1994, 1994, 1994, 1994, 1994, 1994, 1994, 1994, 19…\n$ rec_month     <dbl> 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, …\n$ rec_day       <dbl> 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,…\n$ animal_code   <chr> \"813\", \"834\", \"B-301\", \"B-402\", \"B-403\", \"B-502\", \"B-503…\n$ animal_sex    <chr> \"F\", \"F\", \"F\", \"F\", \"F\", \"F\", \"F\", \"F\", \"F\", \"F\", \"F\", \"…\n$ animal_weight <dbl> 890, 1074, 1060, 989, 1062, 978, 1068, 1024, 978, 1188, …\n$ animal_yob    <dbl> 1981, 1983, 1983, 1984, 1984, 1985, 1985, 1985, 1986, 19…\n```\n\n\n:::\n:::\n\n\n\n\n## Population Concepts\n\n### Understanding Populations and Samples\n\nLet's examine the bison weight measurements as our population:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Population summary\nsummary(knz_bison$animal_weight)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n   90.0   454.0   777.0   749.5   986.0  2050.0       1 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Visualise the population distribution\nggplot(knz_bison, aes(x = animal_weight)) +\n  geom_histogram(bins = 30) +\n  labs(\n    x = \"Bison Weight (kg)\",\n    y = \"Count\",\n    title = \"Distribution of Bison Weight Measurements\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 1 row containing non-finite outside the scale range\n(`stat_bin()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03-central_limit_theorem_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n### Natural Variation in Ecological Data\n\nBison weight varies due to multiple factors:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Examine variation across years\nggplot(knz_bison, aes(x = as.factor(rec_year), y = animal_weight)) +\n  geom_boxplot() +\n  labs(\n    x = \"Year\",\n    y = \"Bison Weight (kg)\",\n    title = \"Bison Weight Variation Across Years\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 1 row containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03-central_limit_theorem_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n## Sampling Distributions\n\n### Creating Sample Means\n\nLet's demonstrate how sample means behave:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to calculate mean of random sample\nget_sample_mean <- function(data, n) {\n  sample_data <- sample(data, size = n, replace = TRUE)\n  mean(sample_data, na.rm = TRUE)\n}\n\n# Take multiple samples and calculate means\nset.seed(123) # For reproducibility\nsample_means_small <- replicate(\n  1000,\n  get_sample_mean(knz_bison$animal_weight, n = 5)\n)\n\nsample_means_large <- replicate(\n  1000,\n  get_sample_mean(knz_bison$animal_weight, n = 30)\n)\n\n# Create dataframe for plotting\nsample_means_df <- data.frame(\n  mean = c(sample_means_small, sample_means_large),\n  sample_size = rep(c(\"n = 5\", \"n = 30\"), each = 1000)\n)\n\n# Plot distributions of sample means\nggplot(sample_means_df, aes(x = mean)) +\n  geom_histogram(bins = 30) +\n  facet_wrap(~sample_size) +\n  geom_vline(\n    aes(xintercept = mean(knz_bison$animal_weight, na.rm = TRUE)),\n    color = \"red\",\n    linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"Sample Mean Weight (kg)\",\n    y = \"Count\",\n    title = \"Distribution of Sample Means\",\n    subtitle = \"Red line shows population mean\"\n  )\n```\n\n::: {.cell-output-display}\n![](03-central_limit_theorem_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n### Sample Size Effects\n\nCompare variability in sample means with different sample sizes:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate standard deviations of sampling distributions\nsample_means_df %>%\n  group_by(sample_size) %>%\n  summarise(\n    sd = sd(mean, na.rm = TRUE),\n    mean = mean(mean, na.rm = TRUE)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  sample_size    sd  mean\n  <chr>       <dbl> <dbl>\n1 n = 30       62.7  747.\n2 n = 5       156.   747.\n```\n\n\n:::\n:::\n\n\n\n\nNote how the larger sample size produces less variable sample means.\n\n### Building Understanding\n\nKey observations about sampling distributions:\n1. They're more normal than the population distribution\n2. They center around the population mean\n3. Their spread decreases with larger sample sizes\n\n## The Central Limit Theorem\n\n### Main Principles\n\nThe CLT states that the sampling distribution of means:\n1. Approaches a normal distribution\n2. Has a mean equal to the population mean\n3. Has a standard error = $\\frac{\\sigma}{\\sqrt{n}}$\n\nLet's demonstrate this:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to test normality of sampling distribution\nsample_distribution_test <- function(data, n_samples, sample_size) {\n  sample_means <- replicate(\n    n_samples,\n    get_sample_mean(data, sample_size)\n  )\n\n  # Create QQ plot\n  means_df <- data.frame(means = sample_means)\n\n  ggplot(means_df, aes(sample = means)) +\n    stat_qq() +\n    stat_qq_line() +\n    labs(\n      title = paste(\"Normal Q-Q Plot (n =\", sample_size, \")\"),\n      x = \"Theoretical Quantiles\",\n      y = \"Sample Quantiles\"\n    )\n}\n\n# Test with different sample sizes\nsample_distribution_test(knz_bison$animal_weight, 1000, 5)\n```\n\n::: {.cell-output-display}\n![](03-central_limit_theorem_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsample_distribution_test(knz_bison$animal_weight, 1000, 30)\n```\n\n::: {.cell-output-display}\n![](03-central_limit_theorem_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\n\n\n### Standard Error\n\nThe standard error decreases with sample size:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate standard error for different sample sizes\nsample_sizes <- c(5, 10, 30, 50)\nstandard_errors <- sapply(sample_sizes, function(n) {\n  samples <- replicate(1000, get_sample_mean(knz_bison$animal_weight, n))\n  sd(samples, na.rm = TRUE)\n})\n\n# Plot relationship\nse_df <- data.frame(\n  sample_size = sample_sizes,\n  standard_error = standard_errors\n)\n\nggplot(se_df, aes(x = sample_size, y = standard_error)) +\n  geom_point() +\n  geom_line() +\n  labs(\n    x = \"Sample Size\",\n    y = \"Standard Error\",\n    title = \"Standard Error vs Sample Size\",\n    subtitle = \"Demonstrates decrease in SE with larger samples\"\n  )\n```\n\n::: {.cell-output-display}\n![](03-central_limit_theorem_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n## Practical Applications\n\n### In Ecological Research\n\nThe CLT helps us:\n1. Plan appropriate sample sizes\n2. Make inferences about populations\n3. Understand sampling variation\n4. Design effective monitoring programs\n\n### Field Implementation\n\nWhen designing animal surveys:\n1. Consider required precision (affects sample size)\n2. Account for natural variation\n3. Balance cost and statistical power\n4. Plan for long-term monitoring\n\n## Summary\n\nWe've learned how:\n- Sample means form a sampling distribution\n- The CLT describes this distribution's properties\n- Sample size affects sampling variation\n- These concepts apply to ecological research\n\nThis understanding is crucial for:\n- Research design\n- Data interpretation\n- Statistical inference\n- Environmental monitoring\n",
    "supporting": [
      "03-central_limit_theorem_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}