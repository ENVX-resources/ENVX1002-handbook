{
  "hash": "fa0c883730364d6399b7b1d0b3e402ca",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Describing and Visualising Data\ndraft: false\nexecute:\n  output: true\n---\n\n\n\n\n\n\n\n## Overview\n\nThis chapter introduces fundamental data visualisation techniques using the grammar of graphics approach through `ggplot2`. We'll use real ecological data to create and customise informative plots while building on the statistical concepts from the previous chapter.\n\n## Data Introduction\n\nWe'll work with two datasets from the Long Term Ecological Research (LTER) Network:\n\n1. **Fiddler Crabs** (`pie_crab`): Body size measurements of fiddler crabs, collected to study population characteristics.\n2. **Sugar Maples** (`hbr_maples`): Tree growth measurements under different environmental conditions.\n\n## Grammar of Graphics with ggplot2\n\nThe `ggplot2` package uses a layered approach to \"paint a canvas\" one component at a time:\n\n1. **Data**: The dataset we're visualising\n2. **Aesthetics**: How variables map to visual elements (what goes on which axis)\n3. **Geometries**: The type of plot that best shows your data patterns\n4. **Additional layers**: Labels, themes, and customisation for clear communication\n\n::: {.callout-tip}\n## Building Plots Step by Step\nJust like writing field methods, build your plots systematically:\n\n1. Start with data (`ggplot(data)`)\n2. Map variables (`aes(x = var1, y = var2)`)\n3. Add plot type (`geom_*()`)\n4. Enhance with labels and themes\n:::\n\n## Core plot types\n\n### Histograms: to understand distributions\n\nHistograms help us see patterns in measurements, like how animal sizes or plant heights are distributed in a population.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Step 1: Start with our data and map size to x-axis\nggplot(pie_crab, aes(x = size)) +\n  # Step 2: Create histogram with 30 bins for detailed view\n  # More bins = more detail, but might show random variation\n  # Fewer bins = smoother pattern, but might miss important details\n  geom_histogram(bins = 30) +\n  # Step 3: Add clear labels for scientific communication\n  labs(\n    x = \"Carapace Width (mm)\",\n    y = \"Count\",\n    title = \"Distribution of Fiddler Crab Sizes\"\n  )\n```\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Add mean line\nggplot(pie_crab, aes(x = size)) +\n  geom_histogram(bins = 30) +\n  geom_vline(aes(xintercept = mean(size, na.rm = TRUE)),\n    color = \"red\", linetype = \"dashed\"\n  ) +\n  labs(\n    x = \"Carapace Width (mm)\",\n    y = \"Count\",\n    title = \"Fiddler Crab Sizes with Mean\"\n  )\n```\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n\n\n\n\n\n### Boxplots: Comparing Groups\n\nThink of a boxplot like a summary of crab sizes at each beach site - just as you might summarize different areas in an ecological survey. Each box tells a story about the crabs living there.\n\nLet's build this plot step by step:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First, let's make a simple comparison between sites\n# Just like comparing different study areas in the field\nggplot(pie_crab, aes(x = site, y = size)) +\n  geom_boxplot() +\n  labs(\n    x = \"Site\",\n    y = \"Carapace Width (mm)\",\n    title = \"Fiddler Crab Sizes by Site\"\n  )\n```\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Now let's make it easier to see differences\n# by adding colors - like marking different study zones\nggplot(pie_crab, aes(x = site, y = size, fill = site)) +\n  geom_boxplot() +\n  labs(\n    x = \"Site\",\n    y = \"Carapace Width (mm)\",\n    title = \"Fiddler Crab Sizes by Site\"\n  )\n```\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n\n\n\nThe box in the middle shows where most of your crabs are (like finding the most common sizes in your sample). The line in the middle is the typical size for that site. This helps us quickly see if crabs are generally larger at some sites than others - just like you might find different sized plants in different parts of a forest.\n```\n\n### Bar Plots: Counting and Comparing\n\nBar plots help us answer questions like \"How many samples did we collect?\" or \"What's the typical size at each site?\" - common questions in field surveys.\n\nFirst, let's count how many crabs we found at each site:\n\n::: {.cell}\n\n```{.r .cell-code}\n# Count crabs at each site (like tallying field observations)\nggplot(pie_crab, aes(x = site)) +\n  geom_bar() +  # geom_bar automatically counts for us\n  labs(\n    x = \"Site\",\n    y = \"Number of Crabs\",\n    title = \"Number of Crabs per Site\"\n  )\n```\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\nNow, let's look at the typical size of crabs at each site. Just like you might measure trees or plants in different areas to see where they grow best:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate average size for each site\n# Think of this like summarizing field measurements\npie_crab %>%\n  # Organize data by site\n  group_by(site) %>%\n  # Calculate the average and its reliability\n  summarise(\n    mean_width = mean(size, na.rm = TRUE), # average size\n    se = sd(size, na.rm = TRUE) / sqrt(n()) # how reliable is our average?\n  ) %>%\n  # Create the plot\n  ggplot(aes(x = site, y = mean_width)) +\n  geom_col() + # make the bars\n  # Add error bars to show reliability\n  geom_errorbar(\n    aes(\n      ymin = mean_width - se,\n      ymax = mean_width + se\n    ),\n    width = 0.2\n  ) +\n  labs(\n    x = \"Site\",\n    y = \"Average Carapace Width (mm)\",\n    title = \"Typical Crab Size at Each Site\"\n  )\n```\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n\nThe height of each bar shows the average size, and the black lines (error bars) tell us how confident we are about that average - just like you might be more confident about your findings when you have more samples.\n```\n\n### Scatterplots: Exploring Relationships\n\nExamine maple growth patterns:\n\n::: {.cell}\n\n```{.r .cell-code}\n# Basic scatterplot\nggplot(hbr_maples, aes(x = year, y = stem_length)) +\n  geom_point() +\n  labs(\n    x = \"Year\",\n    y = \"Stem Length (cm)\",\n    title = \"Sugar Maple Growth Over Time\"\n  )\n```\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Add trend line and group by treatment\nggplot(hbr_maples, aes(\n  x = year, y = stem_length,\n  color = watershed\n)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  labs(\n    x = \"Year\",\n    y = \"Stem Length (cm)\",\n    title = \"Sugar Maple Growth by Watershed\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n## Essential Plot Modifications\n\n### Clear Labels and Titles\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pie_crab, aes(x = site, y = size)) +\n  geom_boxplot() +\n  labs(\n    x = \"Collection Site\",\n    y = \"Carapace Width (mm)\",\n    title = \"Fiddler Crab Size Distribution\",\n    subtitle = \"Comparing sizes across collection sites\",\n    caption = \"Data: PIE LTER\"\n  )\n```\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Appropriate Colours\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using colour-blind friendly palette\nggplot(pie_crab, aes(\n  x = site, y = size,\n  fill = site\n)) +\n  geom_boxplot() +\n  scale_fill_brewer(palette = \"Set2\") +\n  labs(\n    x = \"Collection Site\",\n    y = \"Carapace Width (mm)\",\n    title = \"Fiddler Crab Sizes by Site (with colour)\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in RColorBrewer::brewer.pal(n, pal): n too large, allowed maximum for palette Set2 is 8\nReturning the palette you asked for with that many colors\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Scale Adjustments\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Adjust axis limits and breaks\nggplot(hbr_maples, aes(\n  x = year, y = stem_length,\n  color = watershed\n)) +\n  geom_point() +\n  scale_y_continuous(\n    limits = c(0, max(hbr_maples$stem_length, na.rm = TRUE)),\n    breaks = seq(0, max(hbr_maples$stem_length, na.rm = TRUE), by = 50)\n  ) +\n  labs(\n    x = \"Year\",\n    y = \"Stem Length (cm)\"\n  )\n```\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Theme Customisation\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using minimal theme with customisation\nggplot(pie_crab, aes(x = site, y = size)) +\n  geom_boxplot() +\n  labs(\n    x = \"Collection Site\",\n    y = \"Carapace Width (mm)\",\n    title = \"Fiddler Crab Size Distribution\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text = element_text(size = 10),\n    axis.title = element_text(size = 12),\n    plot.title = element_text(size = 14, face = \"bold\"),\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](02-describing_visualising_data_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "02-describing_visualising_data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}